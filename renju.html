<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Cache-Control" content="no-store">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="摆棋小工具">
    <meta name="x5-page-mode" content="app">
    <link rel="shortcut icon" sizes="128x128" href="https://lfz084.github.io/icon.png">
    <link rel="apple-touch-icon" href="https://lfz084.github.io/icon.png">
    <link rel="icon" href="https://lfz084.github.io/icon.ico">
    <title> 摆棋小工具</title>
</head>

<body>
    <script language="javascript">
        "use strict";
        window.APP_VERSION = "v0812.2";
        window.CHECK_VERSION = true;
        window.SCRIPT_VERSION = {
            viewport: 1,
            button: 1,
            emoji: 1,
            checkerBoard: 1,
            control: 1,
            msgbox: 1,
            appData: 1,
            Evaluator: 1,
            engine: 1,
            worker: 1,
            renju: 1
        };
        window.checkVersion = function(filename) {
            return new Promise((resolve, reject) => {
                let ver = self.SCRIPT_VERSION[filename];
                console.log(`[index] \n>> checkVersion \n[${[filename, ver || "undefined"]}]`);
                if (ver && (ver != window.APP_VERSION)) {
                    const ERR = `如果反复刷新无效，请用无痕浏览模式`;
                    const ASK = `版本号不一致，可能影响正常运行。\n\n${strLen("renju.html", 30)}  版本号: ${window.APP_VERSION} \n${strLen(filename+".js", 30)}  版本: ${self.SCRIPT_VERSION[filename]} `;
                    const PS = ` \n\n按确定刷新网页，按取消继续加载`;
                    function strLen(str, len) {
                        return (str + new Array(len).join(" ")).slice(0, len)
                    }
                    
                    if (window.CHECK_VERSION && confirm(ASK + PS)) {
                        reject(ERR)
                    }
                    else {
                        resolve();
                    }
                    window.CHECK_VERSION = false;
                    console.log(ASK);
                }
                else {
                    resolve();
                }
            });
        }
        document.body.onload = () => {
            console.log(`body onload`)
            window.DEBUG = true;
            loadApp();
        };
    </script>
    <script src="./renju-0810.js"></script>
</body>

</html>